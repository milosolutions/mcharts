Code has been written by Aleksey Lysenko and Jakub Motyczko, then refactored
and upgraded by Tomasz Siekierda.
